<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>酷儿: 2016新生同志问题指南</title>
    <link rel="stylesheet" href="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.css" media="screen" title="no title" charset="utf-8">
    <link rel="stylesheet" href="/static/static_zn/css/style.css" media="screen" title="no title" charset="utf-8">
    <script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js" charset="utf-8"></script>
    <script src="//cdn.bootcss.com/jquery-mobile/1.4.5/jquery.mobile.min.js"></script>
    <script src="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.js" charset="utf-8"></script>
    <script src="//cdn.bootcss.com/angular.js/1.5.8/angular.min.js" charset="utf-8"></script>
    <script src="//cdn.bootcss.com/angular.js/1.5.8/angular-route.min.js" charset="utf-8"></script>
    <script src="//cdn.bootcss.com/velocity/1.2.3/velocity.min.js"></script>
    <script src="//cdn.bootcss.com/klass/1.4.1/klass.min.js"></script>
    <script src="//cdn.bootcss.com/photoswipe/4.1.1/photoswipe.min.js"></script>
    <script src="//cdn.bootcss.com/photoswipe/4.1.1/photoswipe-ui-default.js"></script>
    <link rel="stylesheet" href="/static/static_zn/css/ribbon.css" media="screen" title="no title" charset="utf-8">
    <link href="//cdn.bootcss.com/photoswipe/4.1.1/photoswipe.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/photoswipe/4.1.1/default-skin/default-skin.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/semantic-ui/2.2.4/components/loader.min.css" rel="stylesheet">
</head>

<body ng-app="MyApp">

    <div class="ui thin sidebar inverted vertical menu">
        <a class="item" href="#qianyan" target="_self" id="a_qianyan">前言</a>
        <a class="item" href="#ziwopian" target="_self" id="a_ziwopian">自我篇</a>
        <a class="item" href="#shenghuopian" target="_self" id="a_shenghuopian">生活篇</a>
        <a class="item" href="#qingganpian" target="_self" id="a_qingganpian">情感篇</a>
        <a class="item" href="#xingaipian" target="_self" id="a_xingaipian">性爱篇</a>
        <a class="item" href="#anquanpian" target="_self" id="a_anquanpian">安全篇</a>
        <a class="item" href="#gongyipian" target="_self" id="a_gongyipian">公益篇</a>
        <a class="item" href="#houji" target="_self" id="a_houji">后记</a>
        <a class="item" href="#mingxie" target="_self" id="a_mingxie">鸣谢</a>
        <a class="item" href="#guanzhu" target="_self" id="a_guanzhu">关注我们</a>
    </div>
    <div class="dimmed pusher">
        <div class="main" style="">
            <!-- cover -->
            <div class="top_div"></div>

            <div class="ui contents">
                <!-- articles -->
                <div id="qianyan" ng-include="'/static/static_zn/components/qianyan.html'"></div>
                <div id="ziwopian" ng-include="'/static/static_zn/components/ziwopian.html'"></div>
                <div id="shenghuopian" ng-include="'/static/static_zn/components/shenghuopian.html'"></div>
                <div id="qingganpian" ng-include="'/static/static_zn/components/qingganpian.html'"></div>
                <div id="xingaipian" ng-include="'/static/static_zn/components/xingaipian.html'"></div>
                <div id="anquanpian" ng-include="'/static/static_zn/components/anquanpian.html'"></div>
                <div id="gongyipian" ng-include="'/static/static_zn/components/gongyipian.html'"></div>
                <div id="houji" ng-include="'/static/static_zn/components/houji.html'"></div>
                <div id="mingxie" ng-include="'/static/static_zn/components/mingxie.html'"></div>
                <div id="guanzhu" ng-include="'/static/static_zn/components/guanzhu.html'"></div>
            </div>

            <button class="ui button" id="menu_btn">目录</button>
        </div>
        <div ng-include="'/static/static_zn/components/photoSwipe.html'"></div>
    </div>


    <script type="text/javascript">
        var app = angular.module('MyApp', ['ngRoute']);
    </script>

    <script type="text/javascript">
        $(document).ready(function() {

            $(".menu .item").click(function() {
                $('.ui.sidebar').sidebar('toggle');

            });
            // $("#a_anquanpian").click(function() {
            //     $("#anquanpian")
            //         .velocity("scroll", {
            //             duration: 1000,
            //             easing: "ease"
            //         })
            //         .velocity({
            //             opacity: 1
            //         });
            // });

            // $('#menu_btn').css('cursor','pointer');
            // $(document).on('click', '#menu_btn', function(event){
            // 	event.preventDefault();
            // 	menu_btn_func();
            // });


                var user_agent = navigator.userAgent.toLowerCase(); // detect the user agent
            var ios_devices = user_agent.match(/(iphone|ipod|ipad)/) ? "touchstart" : "click";
            //check if the devices are ios devices //
            $('#menu_btn').bind(ios_devices , function() { //bind the ios devices to click event
                menu_btn_func();
            });
            $('#menu_btn').click(menu_btn_func);
            //$('#menu_btn').on('click',menu_btn_func);
            //$("#menu_btn").on("tap",menu_btn_func);
            //$("body").on("swipe",menu_btn_func);
            //document.getElementById("menu_btn").onclick = menu_btn_func;
        });


        function menu_btn_func() {

            $('.ui.sidebar')
                .sidebar('setting', 'transition', 'overlay')
                .sidebar('setting', 'onHidden', function() {
                    $("body").css({
                        "pointer-events": "auto",
                        "cursor": "default"
                    });

                })
                .sidebar('setting', 'onHide', function() {
                    $("body").css({
                        "pointer-events": "none",
                        "cursor": "default"
                    });
                })
                .sidebar('toggle');

        }

        // photoswipe global function
        openPhotoSwipe = function(selector) {

            // prepare images
            // console.log("??????");
            var images = $(selector).find("img");
            // console.log("images", images);
            var items = [];
            for (var i = 0; i < images.length; i++) {
                // console.log(images[i].currentSrc);
                items.push({
                    src: images[i].currentSrc,
                    w: 0,
                    h: 0
                });
            }


            // console.log("ppppp");
            var pswpElement = document.querySelectorAll('.pswp')[0];

            // build items array

            // define options (if needed)
            var options = {
                // history & focus options are disabled on CodePen
                history: false,
                focus: false,
                showHideOpacity: true,
                showAnimationDuration: 0,
                hideAnimationDuration: 0

            };

            var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
            gallery.listen('gettingData', function(index, item) {
                if (item.w < 1 || item.h < 1) { // unknown size
                    var img = new Image();
                    img.onload = function() { // will get size after load
                        item.w = this.width; // set image width
                        item.h = this.height; // set image height
                        gallery.invalidateCurrItems(); // reinit Items
                        gallery.updateSize(true); // reinit Items
                    }
                    img.src = item.src; // lets download image
                }
            });
            gallery.init();
        };

        // function display_alert() {
        //     alert("I am an alert box!!")
        // }
    </script>
</body>

</html>
